<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script>
        // Prevent zoom on desktop (Ctrl+scroll, Ctrl++/-)
        document.addEventListener('wheel', (e) => {
            if (e.ctrlKey) e.preventDefault();
        }, { passive: false });
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && (e.key === '+' || e.key === '-' || e.key === '=' || e.key === '0')) {
                e.preventDefault();
            }
        });
    </script>
    <title>RPG Man</title>
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cdefs%3E%3ClinearGradient id='s' x1='0%25' y1='0%25' x2='0%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%238B7355'/%3E%3Cstop offset='50%25' style='stop-color:%235D4037'/%3E%3Cstop offset='100%25' style='stop-color:%233E2723'/%3E%3C/linearGradient%3E%3C/defs%3E%3Cpath d='M16 2 L28 8 L28 18 L16 30 L4 18 L4 8 Z' fill='url(%23s)' stroke='%23FFD700' stroke-width='1.5'/%3E%3Cpath d='M16 8 L16 24 M13 11 L19 11 M14 24 L18 24' stroke='%23C0C0C0' stroke-width='2' stroke-linecap='round'/%3E%3Ccircle cx='16' cy='11' r='2' fill='%23FFD700'/%3E%3C/svg%3E">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Title Screen -->
    <div id="title-screen">
        <div id="title-content">
            <div class="logo-container">
                <!-- Decorative top emblem -->
                <div class="emblem-top">
                    <svg width="80" height="80" viewBox="0 0 80 80" xmlns="http://www.w3.org/2000/svg">
                        <!-- Shield/Crest background -->
                        <defs>
                            <linearGradient id="shieldGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#8B7355;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#5D4037;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#3E2723;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="swordGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#E0E0E0;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#9E9E9E;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#616161;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <path d="M40 5 L70 20 L70 50 L40 75 L10 50 L10 20 Z" fill="url(#shieldGrad)" stroke="#FFD700"
                            stroke-width="2" />
                        <!-- Crossed swords -->
                        <rect x="25" y="15" width="4" height="40" fill="url(#swordGrad)"
                            transform="rotate(-45 40 40)" />
                        <rect x="51" y="15" width="4" height="40" fill="url(#swordGrad)" transform="rotate(45 40 40)" />
                        <circle cx="28" cy="28" r="5" fill="#FFD700" />
                        <circle cx="52" cy="28" r="5" fill="#FFD700" />
                        <polygon points="40,40 45,50 40,48 35,50" fill="#C0392B" />
                    </svg>
                </div>

                <!-- Main logo text -->
                <div class="game-logo">
                    <div class="logo-text-wrapper">
                        <h1 class="logo-text main-title">
                            <span class="letter">R</span><span class="letter">P</span><span class="letter">G</span>
                        </h1>
                        <h2 class="logo-text sub-title">
                            <span class="letter">M</span><span class="letter">A</span><span class="letter">N</span>
                        </h2>
                        <div class="beta-label">BETA</div>
                    </div>
                </div>

                <!-- Decorative side elements -->
                <div class="side-ornament left">
                    <svg width="60" height="120" viewBox="0 0 60 120" xmlns="http://www.w3.org/2000/svg">
                        <path d="M50 60 Q30 30, 10 60 Q30 90, 50 60" fill="none" stroke="#8B7355" stroke-width="2" />
                        <circle cx="10" cy="60" r="4" fill="#FFD700" />
                        <circle cx="50" cy="60" r="4" fill="#FFD700" />
                        <path d="M30 20 L30 100" stroke="#8B7355" stroke-width="1.5" />
                    </svg>
                </div>
                <div class="side-ornament right">
                    <svg width="60" height="120" viewBox="0 0 60 120" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 60 Q30 30, 50 60 Q30 90, 10 60" fill="none" stroke="#8B7355" stroke-width="2" />
                        <circle cx="50" cy="60" r="4" fill="#FFD700" />
                        <circle cx="10" cy="60" r="4" fill="#FFD700" />
                        <path d="M30 20 L30 100" stroke="#8B7355" stroke-width="1.5" />
                    </svg>
                </div>

            </div>

        </div>
        <!-- Copyright -->
        <div class="copyright">¬© Reko Tech 2025</div>
    </div>

    <div id="game-container">
        <canvas id="gameCanvas"></canvas>

        <!-- UI Overlays -->
        <div id="ui-overlay">
            <!-- Top HUD -->
            <div id="top-hud">
                <div class="stat-bar">
                    <div class="bar-label">HP</div>
                    <div class="bar-container">
                        <div id="hp-bar" class="bar-fill hp"></div>
                        <div class="bar-text"><span id="hp-text">100/100</span></div>
                    </div>
                </div>
                <div class="stat-bar">
                    <div class="bar-label">XP</div>
                    <div class="bar-container">
                        <div id="xp-bar" class="bar-fill xp"></div>
                        <div class="bar-text"><span id="xp-text">0/100</span></div>
                    </div>
                    <div id="xp-gain-indicator"></div>
                </div>
                <div id="stats-display">
                    <div class="stat-item stat-level">
                        <canvas id="level-icon" width="16" height="16"></canvas>
                        <span class="stat-label">LVL</span>
                        <span id="level-text" class="stat-value">1</span>
                    </div>
                    <div class="stat-item stat-coins">
                        <canvas id="coins-icon" width="16" height="16"></canvas>
                        <span id="coins-text" class="stat-value">0</span>
                    </div>
                    <div class="stat-item stat-materials">
                        <canvas id="materials-icon" width="16" height="16"></canvas>
                        <span id="materials-text" class="stat-value">0</span>
                    </div>
                </div>
            </div>

            <!-- Music Controls (Top Right) -->
            <div id="music-controls" class="music-widget">
                <button id="music-toggle" class="music-btn" title="Toggle Music">
                    <span class="music-icon">üéµ</span>
                </button>
                <div id="music-panel" class="music-panel hidden">
                    <div class="music-panel-content">
                        <label class="volume-label">Volume</label>
                        <input type="range" id="music-volume" class="volume-slider" min="0" max="100" value="30">
                        <span id="volume-display" class="volume-value">30%</span>
                    </div>
                </div>
            </div>

            <!-- Active Potions Display (Left Side) -->
            <div id="active-potions-display" class="active-potions-display"></div>

            <!-- Inventory Panel -->
            <div id="character-panel" class="rpg-panel hidden">
                <div class="panel-header">
                    <h2>üéí Inventory</h2>
                    <button class="close-panel" data-panel="character-panel">‚úï</button>
                </div>
                <div class="panel-body">
                    <div class="inventory-layout">
                        <div class="equipped-items">
                            <h3>Equipped</h3>
                            <div class="character-paper-doll">
                                <div class="equipment-slot-row">
                                    <div class="equipment-slot empty" data-slot="weapon" draggable="false">
                                        <div class="slot-icon">‚öîÔ∏è</div>
                                        <div class="slot-label">Weapon</div>
                                        <div class="slot-item-name" id="weapon-name-panel">None</div>
                                    </div>
                                    <div class="equipment-slot empty" data-slot="armor" draggable="false">
                                        <div class="slot-icon">üõ°Ô∏è</div>
                                        <div class="slot-label">Armor</div>
                                        <div class="slot-item-name" id="armor-name-panel">None</div>
                                    </div>
                                </div>
                                <div class="equipment-slot-row">
                                    <div class="equipment-slot empty" data-slot="trinket" draggable="false">
                                        <div class="slot-icon">üíç</div>
                                        <div class="slot-label">Trinket</div>
                                        <div class="slot-item-name" id="trinket-name-panel">None</div>
                                    </div>
                                    <div class="equipment-slot empty" data-slot="boots" draggable="false">
                                        <div class="slot-icon">üë¢</div>
                                        <div class="slot-label">Boots</div>
                                        <div class="slot-item-name" id="boots-name-panel">None</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="inventory-grid-container">
                            <h3>Bag</h3>
                            <div id="inventory-grid" class="inventory-grid">
                                <!-- 20 inventory slots (5x4 grid) -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Upgrade Stats Panel -->
            <div id="upgrade-panel" class="rpg-panel hidden">
                <div class="panel-header">
                    <h2>üîÆ Upgrade Stats</h2>
                    <button class="close-panel" data-panel="upgrade-panel">‚úï</button>
                </div>
                <div class="panel-body">
                    <div class="upgrade-layout">
                        <div class="character-stats">
                            <h3>üìä Current Stats</h3>
                            <div class="stat-line">
                                <span>‚öîÔ∏è Damage:</span>
                                <span id="stat-damage-panel">10</span>
                            </div>
                            <div class="stat-line">
                                <span>üõ°Ô∏è Defense:</span>
                                <span id="stat-defense-panel">5</span>
                            </div>
                            <div class="stat-line">
                                <span>‚ù§Ô∏è Max HP:</span>
                                <span id="stat-hp-panel">100</span>
                            </div>
                            <div class="stat-line">
                                <span>‚ö° Speed:</span>
                                <span id="stat-speed-panel">4.0</span>
                            </div>
                            <div class="stat-line">
                                <span>üí• Crit:</span>
                                <span id="stat-crit-panel">5.0%</span>
                            </div>
                        </div>
                        <div class="stat-upgrades-container">
                            <h3>üí∞ Upgrades</h3>
                            <div id="stat-upgrades"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Blacksmith Panel -->
            <div id="blacksmith-panel" class="rpg-panel hidden">
                <div class="panel-header">
                    <h2>‚öíÔ∏è Blacksmith</h2>
                    <button class="close-panel" data-panel="blacksmith-panel">‚úï</button>
                </div>
                <div class="blacksmith-tabs">
                    <button class="blacksmith-tab active" data-tab="craft">‚öíÔ∏è Craft</button>
                    <button class="blacksmith-tab" data-tab="sell">üí∞ Sell</button>
                </div>
                <div class="panel-body">
                    <div id="blacksmith-craft-content" class="blacksmith-content active">
                        <div id="gear-upgrades"></div>
                    </div>
                    <div id="blacksmith-sell-content" class="blacksmith-content">
                        <div class="sell-info">
                            <div>üëú SELLING FROM YOUR BAG INVENTORY</div>
                            <div style="font-size: 12px; margin-top: 5px; opacity: 0.9;">Click any item below to sell it
                                for 30% of its crafting value</div>
                        </div>
                        <div id="sell-items"></div>
                    </div>
                </div>
            </div>

            <!-- Quests Panel -->
            <div id="quests-panel" class="rpg-panel hidden">
                <div class="panel-header">
                    <h2>üìú Quests</h2>
                    <button class="close-panel" data-panel="quests-panel">‚úï</button>
                </div>
                <div class="panel-body">
                    <div id="quests"></div>
                </div>
            </div>

            <!-- Potion Shop Panel -->
            <div id="potion-shop-panel" class="rpg-panel hidden">
                <div class="panel-header">
                    <h2>üß™ Alchemist Shop</h2>
                    <button class="close-panel" data-panel="potion-shop-panel">‚úï</button>
                </div>
                <div class="panel-body">
                    <!-- Potion Shop Tabs -->
                    <div class="blacksmith-tabs">
                        <button class="blacksmith-tab active" data-tab="potion-buy">Buy</button>
                        <button class="blacksmith-tab" data-tab="potion-sell">Sell</button>
                    </div>

                    <!-- Buy Tab Content -->
                    <div id="potion-buy-content" class="blacksmith-tab-content active">
                        <div class="shop-info">
                            <div>üß™ POTION SHOP</div>
                            <div style="font-size: 12px; margin-top: 5px; opacity: 0.9;">Buy potions and elixirs to aid
                                your adventure</div>
                        </div>
                        <div id="potion-shop-items"></div>
                    </div>

                    <!-- Sell Tab Content -->
                    <div id="potion-sell-content" class="blacksmith-tab-content">
                        <div class="sell-info-banner">
                            <div>üí∞ SELL POTIONS</div>
                            <div style="font-size: 12px; margin-top: 5px;">Sell potions from your bag for <strong>30% of
                                    their value</strong></div>
                        </div>
                        <div id="potion-sell-items"></div>
                    </div>
                </div>
            </div>

            <!-- Damage Numbers -->
            <div id="damage-numbers"></div>

            <!-- Notifications -->
            <div id="notifications"></div>

            <!-- Item Tooltip -->
            <div id="item-tooltip" class="item-tooltip">
                <div class="tooltip-header" id="tooltip-name"></div>
                <div class="tooltip-type" id="tooltip-type"></div>
                <div class="tooltip-stats" id="tooltip-stats"></div>
            </div>

            <!-- Death Screen -->
            <div id="death-screen" class="death-screen hidden">
                <div class="death-message">YOU DIED</div>
                <div class="death-penalty">You lose 20% Gold and Experience</div>
                <button id="try-again-btn" class="try-again-btn">Try Again</button>
            </div>

            <!-- Potion Belt -->
            <div id="potion-belt" class="potion-belt">
                <div class="potion-belt-slot" data-slot="0">
                    <div class="belt-keybind">1</div>
                </div>
                <div class="potion-belt-slot" data-slot="1">
                    <div class="belt-keybind">2</div>
                </div>
                <div class="potion-belt-slot" data-slot="2">
                    <div class="belt-keybind">3</div>
                </div>
                <div class="potion-belt-slot" data-slot="3">
                    <div class="belt-keybind">4</div>
                </div>
            </div>

            <!-- Spell Slot (next to potion belt) -->
            <div id="spell-slot" class="spell-slot locked" title="Thunderstrike (Q) - Locked">
                <div class="spell-keybind">Q</div>
                <div class="spell-icon">‚ö°</div>
                <div class="spell-cooldown-overlay"></div>
                <div class="spell-cooldown-text"></div>
                <div class="spell-lock-overlay">üîí</div>
            </div>

            <!-- Potion Belt Tutorial Hint -->
            <div id="potion-belt-hint" class="potion-belt-hint hidden">
                <span class="hint-arrow">‚Üì</span><span class="hint-text">Drag potions here</span><button
                    class="hint-close">OK</button>
            </div>

            <!-- Bottom Right Panel Icons -->
            <div class="panel-icons">
                <button class="panel-icon" data-panel="character-panel" title="Inventory (C)">
                    <div class="keybind">C</div>
                    <div class="icon">üéí</div>
                    <div class="label">Inventory</div>
                </button>
                <button class="panel-icon" data-panel="upgrade-panel" title="Upgrade Stats (U)">
                    <div class="keybind">U</div>
                    <div class="icon">üîÆ</div>
                    <div class="label">Upgrade</div>
                </button>
                <button class="panel-icon" data-panel="quests-panel" title="Quests (L)">
                    <div class="keybind">L</div>
                    <div class="icon">üìú</div>
                    <div class="label">Quests</div>
                </button>
            </div>

            <!-- Debug Button (hidden in production) -->
            <button id="debug-btn" class="debug-btn hidden" title="Open Debug Menu">üêõ Debug</button>
        </div>

        <!-- Debug Menu -->
        <div id="debug-menu" class="debug-menu hidden">
            <div class="debug-menu-content">
                <div class="debug-menu-header">
                    <h2>üêõ Developer Debug Menu</h2>
                    <button class="close-debug-menu" id="close-debug-btn">‚úï</button>
                </div>
                <div class="debug-menu-body">
                    <div class="debug-section">
                        <h3>üí∞ Resources</h3>
                        <button id="toggle-infinite-btn" class="debug-action-btn resource-btn">
                            <span class="btn-icon">‚àû</span>
                            <span class="btn-label">Toggle Infinite Resources</span>
                            <span class="btn-status" id="infinite-status">OFF</span>
                        </button>
                        <p class="debug-hint">Set coins and materials to 999,999 or reset to 0</p>
                    </div>

                    <div class="debug-section">
                        <h3>üîÑ Game State</h3>
                        <button id="kill-player-btn" class="debug-action-btn danger-btn">
                            <span class="btn-icon">‚ò†Ô∏è</span>
                            <span class="btn-label">Kill Player Character</span>
                        </button>
                        <p class="debug-hint">Test the death system and penalties</p>

                        <button id="reset-game-btn" class="debug-action-btn danger-btn">
                            <span class="btn-icon">‚ö†Ô∏è</span>
                            <span class="btn-label">Reset Game & Clear Saves</span>
                        </button>
                        <p class="debug-hint">‚ö†Ô∏è This will delete all progress and reload the game</p>
                    </div>

                    <div class="debug-section">
                        <h3>üó∫Ô∏è Zone Teleport</h3>
                        <select id="zone-teleport-select" class="zone-select">
                            <option value="">-- Select Zone --</option>
                        </select>
                        <button id="teleport-btn" class="debug-action-btn teleport-btn">
                            <span class="btn-icon">‚ö°</span>
                            <span class="btn-label">Teleport to Zone</span>
                        </button>
                        <p class="debug-hint">Instantly travel to any zone (bypasses level requirements)</p>
                    </div>

                    <div class="debug-section">
                        <h3>‚ÑπÔ∏è Current Stats</h3>
                        <div class="debug-info">
                            <div class="info-row">
                                <span>Coins:</span>
                                <span id="debug-coins">0</span>
                            </div>
                            <div class="info-row">
                                <span>Materials:</span>
                                <span id="debug-materials">0</span>
                            </div>
                            <div class="info-row">
                                <span>Level:</span>
                                <span id="debug-level">1</span>
                            </div>
                            <div class="info-row">
                                <span>XP:</span>
                                <span id="debug-xp">0</span>
                            </div>
                            <div class="info-row">
                                <span>Current Zone:</span>
                                <span id="debug-zone">hub</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tutorial Popup -->
        <div id="tutorial-popup" class="tutorial-popup hidden">
            <div class="tutorial-content">
                <div class="tutorial-header">
                    <h2>‚öîÔ∏è Welcome, Adventurer! ‚öîÔ∏è</h2>
                    <div class="tutorial-subtitle">Master the Controls</div>
                </div>
                <div class="tutorial-body">
                    <div class="control-section">
                        <h3>üéÆ Movement</h3>
                        <div class="control-group">
                            <div class="control-item">
                                <div class="key-display">A D</div>
                                <div class="control-desc">Move left and right</div>
                            </div>
                            <div class="control-item">
                                <div class="key-display">S</div>
                                <div class="control-desc">Drop through platforms</div>
                            </div>
                            <div class="control-item">
                                <div class="key-display">SPACE</div>
                                <div class="control-desc">Jump (press twice for double jump!)</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-section">
                        <h3>‚öîÔ∏è Combat</h3>
                        <div class="control-group">
                            <div class="control-item">
                                <div class="key-display mouse">Left Click</div>
                                <div class="control-desc">Attack enemies with your weapon</div>
                            </div>
                            <div class="control-item">
                                <div class="key-display mouse">Right Click</div>
                                <div class="control-desc">Block all damage (move 50% slower, can't jump or attack)</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-section">
                        <h3>üì¶ Panels & Management</h3>
                        <div class="control-group">
                            <div class="control-item">
                                <div class="key-display">C</div>
                                <div class="control-desc">üéí Inventory - Manage equipment & items</div>
                            </div>
                            <div class="control-item">
                                <div class="key-display">U</div>
                                <div class="control-desc">üîÆ Upgrade - Boost your stats permanently</div>
                            </div>
                            <div class="control-item">
                                <div class="key-display">B</div>
                                <div class="control-desc">‚öíÔ∏è Blacksmith - Craft powerful gear</div>
                            </div>
                            <div class="control-item">
                                <div class="key-display">Q</div>
                                <div class="control-desc">‚ö° Thunderstrike - Lightning spell (unlocked after Deep Mines)
                                </div>
                            </div>
                            <div class="control-item">
                                <div class="key-display">L</div>
                                <div class="control-desc">üìú Quests - Track your objectives</div>
                            </div>
                            <div class="control-item">
                                <div class="key-display">ESC</div>
                                <div class="control-desc">Close any open panel</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tutorial-footer">
                    <button id="tutorial-ok-btn" class="tutorial-ok-btn">‚öîÔ∏è Begin Your Adventure! ‚öîÔ∏è</button>
                </div>
            </div>
        </div>
    </div>

    <script src="sounds.js"></script>
    <script src="musiccontrol.js"></script>
    <script src="data.js"></script>
    <script src="utils.js"></script>
    <script src="levelgen.js"></script>
    <script src="itemicons.js"></script>
    <script src="staticons.js"></script>
    <script src="cavehub.js"></script>
    <script src="slimecave.js"></script>
    <script src="npc.js"></script>
    <script src="player.js"></script>
    <script src="enemy.js"></script>
    <script src="particle.js"></script>
    <script src="drop.js"></script>
    <script src="projectile.js"></script>
    <script src="portal.js"></script>
    <script src="ui.js"></script>
    <script src="game.js"></script>

    <script>
        // Title Screen Logic
        window.addEventListener('load', () => {
            const titleScreen = document.getElementById('title-screen');
            const subtitle = document.getElementById('subtitle');
            if (subtitle) subtitle.style.display = 'none'; // Ensure text is gone

            // Pause the game initially
            const checkGameInterval = setInterval(() => {
                if (window.game) {
                    window.game.paused = true;
                    clearInterval(checkGameInterval);
                }
            }, 50);

            // Auto-dismiss after 4 seconds
            setTimeout(() => {
                titleScreen.classList.add('fade-out');
                setTimeout(() => {
                    titleScreen.style.display = 'none';
                    if (window.game) window.game.paused = false;
                }, 500);
            }, 4000);
        });
    </script>
</body>

</html>